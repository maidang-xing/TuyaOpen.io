<!doctype html><html lang=zh dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-peripheral/button" data-has-hydrated=false><head><meta charset=UTF-8><meta name=generator content="Docusaurus v3.9.2"><title data-rh=true>按键驱动 | TuyaOpen</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"/><meta data-rh=true name=twitter:card content=summary_large_image /><meta data-rh=true property=og:image content=https://tuyaopen.io/zh/img/home/tuyaopen-logo-social-preview.png /><meta data-rh=true name=twitter:image content=https://tuyaopen.io/zh/img/home/tuyaopen-logo-social-preview.png /><meta data-rh=true property=og:url content=https://tuyaopen.io/zh/docs/peripheral/button /><meta data-rh=true property=og:locale content=zh /><meta data-rh=true property=og:locale:alternate content=en /><meta data-rh=true name=docusaurus_locale content=zh /><meta data-rh=true name=docsearch:language content=zh /><meta data-rh=true name=docusaurus_version content=current /><meta data-rh=true name=docusaurus_tag content=docs-default-current /><meta data-rh=true name=docsearch:version content=current /><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current /><meta data-rh=true property=og:title content="按键驱动 | TuyaOpen"/><meta data-rh=true name=description content=概述 /><meta data-rh=true property=og:description content=概述 /><link data-rh=true rel=icon href=/zh/img/favicon.ico /><link data-rh=true rel=canonical href=https://tuyaopen.io/zh/docs/peripheral/button /><link data-rh=true rel=alternate href=https://tuyaopen.io/docs/peripheral/button hreflang=en /><link data-rh=true rel=alternate href=https://tuyaopen.io/zh/docs/peripheral/button hreflang=zh /><link data-rh=true rel=alternate href=https://tuyaopen.io/docs/peripheral/button hreflang=x-default /><link data-rh=true rel=preconnect href=https://NT1L7IWROF-dsn.algolia.net crossorigin=anonymous /><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://tuyaopen.io/zh/docs/peripheral/button","name":"按键驱动","position":1}]}</script><link rel=alternate type=application/rss+xml href=/zh/blog/rss.xml title="TuyaOpen RSS Feed"><link rel=alternate type=application/atom+xml href=/zh/blog/atom.xml title="TuyaOpen Atom Feed"><link rel=preconnect href=https://www.google-analytics.com><link rel=preconnect href=https://www.googletagmanager.com><script async src="https://www.googletagmanager.com/gtag/js?id=G-3M0J54E8XF"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-3M0J54E8XF",{})</script><link rel=search type=application/opensearchdescription+xml title=TuyaOpen href=/zh/opensearch.xml><link rel=preconnect href=https://www.clarity.ms><script>!function(t,e,n,c,r,s,a){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(s=e.createElement(c)).async=1,s.src="https://www.clarity.ms/tag/"+r,(a=e.getElementsByTagName(c)[0]).parentNode.insertBefore(s,a)}(window,document,"clarity","script","lggqck9srz")</script><meta name=algolia-site-verification content=6232065417750C16><link rel=stylesheet href=/zh/assets/css/styles.92660d3d.css /><script src=/zh/assets/js/runtime~main.a368cd72.js defer></script><script src=/zh/assets/js/main.25a09bff.js defer></script></head><body class=navigation-with-keyboard><svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label=跳到主要内容><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>跳到主要内容</a></div><nav aria-label=主导航 class="theme-layout-navbar navbar navbar--fixed-top navbarHideable_m1mJ"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label=切换导航栏 aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/zh/><div class=navbar__logo><img src=/zh/img/home/tuyaopen-logo-simple-dark.png alt=TuyaOpen class="themedComponent_mlkZ themedComponent--light_NVdE"/><img src=/zh/img/home/tuyaopen-logo-simple-light.png alt=TuyaOpen class="themedComponent_mlkZ themedComponent--dark_xIcU"/></div><b class="navbar__title text--truncate">TuyaOpen</b></a><a class="navbar__item navbar__link" href=/zh/docs/about-tuyaopen>文档</a><div class="navbar__item dropdown dropdown--hoverable"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link>获取</a><ul class=dropdown__menu><li><a class=dropdown__link href=/zh/pricing>服务授权码</a><li><a class=dropdown__link href=/zh/get-hardware>获取硬件</a><li><a href=https://github.com/tuya/TuyaOpen target=_blank rel="noopener noreferrer" class=dropdown__link>获取代码<svg width=12 height=12 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div><a class="navbar__item navbar__link" href=/zh/blog>博客</a><a class="navbar__item navbar__link" href=/zh/projects>项目</a><div class="navbar__item dropdown dropdown--hoverable"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link>工具</a><ul class=dropdown__menu><li><a class=dropdown__link href=/zh/tools/tyutool>涂鸦通用串口工具</a><li><a href=https://tuyaopen.ai/tools target=_blank rel="noopener noreferrer" class=dropdown__link>Web串口/烧录工具<svg width=12 height=12 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link><svg viewBox="0 0 24 24" width=20 height=20 aria-hidden=true class=iconLanguage_nlXk><path fill=currentColor d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>简体中文</a><ul class=dropdown__menu><li><a href=/docs/peripheral/button target=_self rel="noopener noreferrer" class=dropdown__link lang=en>English</a><li><a href=/zh/docs/peripheral/button target=_self rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang=zh>简体中文</a></ul></div><a href=https://github.com/tuya/TuyaOpen target=_blank rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label=GitHub></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="搜索 (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>搜索</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label=回到顶部 class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex=-1 class=sidebarLogo_isFc href=/zh/><img src=/zh/img/home/tuyaopen-logo-simple-dark.png alt=TuyaOpen class="themedComponent_mlkZ themedComponent--light_NVdE"/><img src=/zh/img/home/tuyaopen-logo-simple-light.png alt=TuyaOpen class="themedComponent_mlkZ themedComponent--dark_xIcU"/><b>TuyaOpen</b></a><nav aria-label=文档侧边栏 class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/zh/docs/about-tuyaopen><span title="关于 TuyaOpen" class=linkLabel_WmDU>关于 TuyaOpen</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/zh/docs/maintenance-and-releases><span title="技术 Roadmap 与发布" class=linkLabel_WmDU>技术 Roadmap 与发布</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/zh/docs/project-walkthrough><span title=目录结构 class=linkLabel_WmDU>目录结构</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/zh/docs/quick-start><span title=快速开始 class=categoryLinkLabel_W154>快速开始</span></a><button aria-label="折叠侧边栏分类 '快速开始'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/zh/docs/quick-start/unboxing><span title=极速体验 class=linkLabel_WmDU>极速体验</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/zh/docs/quick-start/enviroment-setup><span title=环境搭建 class=linkLabel_WmDU>环境搭建</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/zh/docs/quick-start/project-compilation><span title=项目编译 class=linkLabel_WmDU>项目编译</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/zh/docs/quick-start/firmware-burning><span title=固件烧录 class=linkLabel_WmDU>固件烧录</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/zh/docs/quick-start/equipment-authorization><span title=设备授权 class=linkLabel_WmDU>设备授权</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/zh/docs/quick-start/device-network-configuration><span title=设备配网 class=linkLabel_WmDU>设备配网</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/zh/docs/quick-start/device-debug><span title=设备调试 class=linkLabel_WmDU>设备调试</span></a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/zh/docs/hardware-specific><span title=硬件文档 class=categoryLinkLabel_W154>硬件文档</span></a><button aria-label="折叠侧边栏分类 '硬件文档'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=true tabindex=0 href=/zh/docs/hardware-specific/t5-ai-board/overview-t5-ai-board><span title="T5-AI Board DevKit" class=categoryLinkLabel_W154>T5-AI Board DevKit</span></a></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/zh/docs/hardware-specific/t5-ai-board/overview-t5-ai-board><span title="T5AI-Board 概述" class=linkLabel_WmDU>T5AI-Board 概述</span></a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=true tabindex=0 href=/zh/docs/hardware-specific/t5-ai-core/overview-t5-ai-core><span title="T5-AI Core DevKit" class=categoryLinkLabel_W154>T5-AI Core DevKit</span></a></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/zh/docs/hardware-specific/t5-ai-core/overview-t5-ai-core><span title="T5AI-Core 概述" class=linkLabel_WmDU>T5AI-Core 概述</span></a></ul></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/zh/docs/applications><span title=应用示例 class=categoryLinkLabel_W154>应用示例</span></a><button aria-label="展开侧边栏分类 '应用示例'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/zh/docs/examples/demo-generic-examples><span title=示例 class=categoryLinkLabel_W154>示例</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true href=/zh/docs/peripheral/support_peripheral_list><span title=外设驱动 class=categoryLinkLabel_W154>外设驱动</span></a></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/zh/docs/peripheral/support_peripheral_list><span title=外设驱动列表 class=linkLabel_WmDU>外设驱动列表</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/zh/docs/peripheral/display><span title=显示屏驱动 class=linkLabel_WmDU>显示屏驱动</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/zh/docs/peripheral/audio><span title=音频驱动 class=linkLabel_WmDU>音频驱动</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/zh/docs/peripheral/button><span title=按键驱动 class=linkLabel_WmDU>按键驱动</span></a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/zh/docs/new-hardware/porting-platform><span title=添加新项目 class=categoryLinkLabel_W154>添加新项目</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=true href=/zh/docs/cloud/tuya-cloud/creating-new-product><span title=云服务 class=categoryLinkLabel_W154>云服务</span></a></div><ul class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=true tabindex=0 href=/zh/docs/cloud/tuya-cloud/creating-new-product><span title=涂鸦云平台开发 class=categoryLinkLabel_W154>涂鸦云平台开发</span></a></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/zh/docs/cloud/tuya-cloud/creating-new-product><span title=创建新产品 class=linkLabel_WmDU>创建新产品</span></a></ul></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/zh/docs/tkl-api/tkl_mutex><span title="TKL APIs" class=categoryLinkLabel_W154>TKL APIs</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/zh/docs/tos-tools/tos-guide><span title="Tos 工具" class=categoryLinkLabel_W154>Tos 工具</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/zh/docs/build-system/compilation-guide><span title=构建系统 class=categoryLinkLabel_W154>构建系统</span></a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/zh/docs/faqs><span title=FAQs class=linkLabel_WmDU>FAQs</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/zh/docs/contribute/contribute-guide><span title=贡献 class=categoryLinkLabel_W154>贡献</span></a></div></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=页面路径><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label=主页面 class=breadcrumbs__link href=/zh/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><span class=breadcrumbs__link>外设驱动</span><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>按键驱动</span></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1 id=按键驱动>按键驱动</h1></header>
<h2 id=概述>概述</h2>
<p><a href=https://github.com/tuya/TuyaOpen/tree/master/src/peripherals/button>按键驱动</a> 是 TuyaOpen 中用于处理用户输入的核心组件。它提供了统一的接口来管理不同类型的按键设备，支持多种按键事件检测和处理机制。通过这个驱动，应用可以轻松地实现按键输入检测、事件处理和状态管理，而无需关心底层硬件的具体实现细节。</p>
<h2 id=前置概念>前置概念</h2>
<table><thead><tr><th>名词<th style=text-align:left>解释<tbody><tr><td>GPIO<td style=text-align:left>通用输入输出引脚，用于连接按键等外部设备<tr><td>消抖<td style=text-align:left>按键在按下或松开时会产生机械抖动，需要通过软件或硬件方式消除<tr><td>上拉/下拉<td style=text-align:left>GPIO 引脚的电平配置方式，用于确定按键未按下时的默认状态<tr><td>中断<td style=text-align:left>硬件事件触发的异步通知机制，可实现低功耗的按键检测<tr><td>轮询<td style=text-align:left>定时检查按键状态的检测方式，适用于简单应用场景<tr><td>有效电平<td style=text-align:left>按键按下时 GPIO 引脚的电平状态，可配置为高电平或低电平有效<tr><td>边沿触发<td style=text-align:left>中断触发方式，可配置为上升沿、下降沿或双边沿触发<tr><td>状态机<td style=text-align:left>用于管理按键事件检测和处理的逻辑控制机制</table>
<h2 id=按键连接框架>按键连接框架</h2>
<p>根据硬件设计的不同，按键连接方式也会有所不同。常见的连接方式包括上拉按键和下拉按键两种。</p>
<h3 id=上拉按键连接框架>上拉按键连接框架</h3>
<p><img alt="pullup button" src=/zh/assets/images/pullup_button-4cbcc774ca127a8cf24a924f858a040f.png width=613 height=318 /></p>
<h3 id=下拉按键连接框架>下拉按键连接框架</h3>
<p><img alt="pulldown button" src=/zh/assets/images/pulldown_button-eb365852610ea5c6194b6dd1fecd8bfa.png width=587 height=331 /></p>
<h2 id=功能模块>功能模块</h2>
<p>TuyaOpen 旨在提供一个标准化的、与平台无关的按键解决方案，核心的设计思想是分层解耦。它将应用层对按键的需求与底层具体的硬件实现分离开。</p>
<ul>
<li><strong>对应用开发者而言</strong>：无论底层用的是什么芯片的 GPIO，应用层都只需要调用一套统一的、标准化的 API（<code>tdl_button_xxx</code> 系列函数），如 <code>tdl_button_create</code>、<code>tdl_button_event_register</code> 等。这大大降低了应用开发的复杂性，提高了代码的可移植性。</li>
<li><strong>对驱动开发者而言</strong>：当需要支持一款新的硬件平台时，只需要遵循 <code>tdl_button_driver.h</code> 定义的标准接口，编写一个新的 TDD 层驱动（类似 <code>tdd_button_gpio.c</code>），然后注册到 TDL 管理层即可，无需改动任何应用层代码。</li>
</ul>
<h3 id=抽象管理模块tuya-driver-layertdl>抽象管理模块（Tuya Driver Layer，TDL）</h3>
<p>这是最高层的抽象，面向应用层提供统一的按键服务接口。</p>
<ul>
<li><code>tdl_button_manage.c/h</code>：实现了按键驱动的管理核心。它维护一个链表，用于注册和管理不同类型（或不同平台）的按键设备驱动。应用通过调用 <code>tdl_button_create</code>、<code>tdl_button_event_register</code> 等函数来使用按键功能，而无需关心底层的具体实现。</li>
<li><code>tdl_button_driver.h</code>：定义了所有按键设备驱动必须遵守的 <strong>标准化接口</strong>（<code>TDL_BUTTON_CTRL_INFO</code>），包括 <code>button_create</code>、<code>button_delete</code>、<code>read_value</code> 等函数指针。这确保了 <code>tdl_button_manage</code> 可以统一地调用任何符合该标准的底层驱动。</li>
</ul>
<h3 id=实例化注册模块tuya-device-drivertdd>实例化注册模块（Tuya Device Driver，TDD）</h3>
<p>这是驱动的中间层，是特定硬件平台的具体实现。</p>
<p><code>tdd_button_gpio.c/h</code>：针对 GPIO 按键的驱动实现。它负责承上启下，向上实现了 TDL 所定义的 <code>TDL_BUTTON_CTRL_INFO</code> 标准接口，向下调用 TKL 层的 GPIO 接口来控制真实的硬件。<code>tdd_gpio_button_register</code> 函数会将这个驱动的实现（函数指针）注册到 TDL 层。</p>
<h2 id=功能介绍>功能介绍</h2>
<p><strong>按键事件检测</strong></p>
<ul>
<li>多种事件类型：支持按下、松开、单击、双击、多击、长按开始、长按保持等多种按键事件。</li>
<li>异步事件回调：驱动采用回调机制（<code>TDL_BUTTON_EVENT_CB</code>）将检测到的按键事件实时推送给应用层。应用层无需主动轮询按键状态，而是被动接收事件通知，效率更高。</li>
<li>状态机处理：内部使用状态机来管理按键的各种状态转换，确保事件检测的准确性和可靠性。</li>
</ul>
<p><strong>按键扫描模式</strong></p>
<ul>
<li>定时扫描模式：通过定时器定期检查按键状态，适用于对功耗要求不高的应用场景。</li>
<li>中断扫描模式：利用 GPIO 中断机制检测按键状态变化，实现低功耗的按键检测，适用于电池供电设备。</li>
</ul>
<p><strong>消抖处理</strong></p>
<ul>
<li>软件消抖：通过可配置的消抖时间参数，有效消除按键机械抖动带来的误触发。</li>
<li>灵活配置：消抖时间可根据不同按键的特性进行个性化配置。</li>
</ul>
<p><strong>长按功能</strong></p>
<ul>
<li>可配置的长按检测：支持配置长按开始时间和长按保持触发间隔。</li>
<li>长按事件分离：区分长按开始事件和长按保持事件，满足不同应用需求。</li>
</ul>
<p><strong>多击检测</strong></p>
<ul>
<li>双击/多击支持：支持双击和多击事件检测，可配置多击的有效次数和时间窗口。</li>
<li>灵活的时间配置：可配置多击事件的有效时间间隔。</li>
</ul>
<p><strong>可扩展的驱动管理</strong></p>
<ul>
<li>动态注册与发现：系统可以同时注册多个不同的按键驱动。</li>
<li>按名查找：应用层可以通过一个字符串名称来查找并获取特定按键设备的句柄，实现了灵活的设备选择。</li>
</ul>
<h2 id=支持外设列表>支持外设列表</h2>
<table><thead><tr><th style=text-align:center>按键类型<th style=text-align:center>轮询扫描<th style=text-align:center>中断扫描<tbody><tr><td style=text-align:center>GPIO 按键<td style=text-align:center>✅<td style=text-align:center>✅<tr><td style=text-align:center>矩阵键盘<td style=text-align:center>✅<td style=text-align:center>✅<tr><td style=text-align:center>电容触摸按键<td style=text-align:center>❌<td style=text-align:center>❌<tr><td style=text-align:center>ADC 按键<td style=text-align:center>❌<td style=text-align:center>❌</table>
<h2 id=工作流程>工作流程</h2>
<p>以 GPIO 按键为例，介绍按键驱动框架工作流程。</p>
<mermaid value="sequenceDiagram
    participant App as 应用程序
    participant TDL as 按键抽象层
    participant TDD as 按键设备驱动
    participant Bd as 板级配置

    Note over App, Bd: 注册按键设备
    
    Bd->>+TDD: 调用 tdd_gpio_button_register
    Note right of Bd: 传入 BUTTON_NAME<br/>传入 BUTTON_GPIO_CFG_T 配置参数<br/>- pin: GPIO 引脚号<br/>- mode: 扫描模式(轮询/中断)<br/>- level: 有效电平<br/>- pin_type: 引脚配置(上拉/下拉/中断边沿)
    
    TDD->>+TDL: 调用 tdl_button_register
    Note right of TDD: 注册设备名称<br/>注册按键接口 (TDL_BUTTON_CTRL_INFO)<br/>- __tdd_create_gpio_button<br/>- __tdd_delete_gpio_button<br/>- __tdd_read_gpio_value
    
    Note over TDL: 创建按键节点 (TDL_BUTTON_LIST_NODE_T)<br/>将节点添加到按键列表 (__tdl_button_add_node)
    
    TDL-->>-TDD: 返回注册结果
    TDD-->>-Bd: 返回注册结果

    Note over App, Bd: 创建按键设备实例
    
    App->>+TDL: 调用 tdl_button_create
    Note right of App: 传入设备名称<br/>传入 TDL_BUTTON_CFG_T 配置参数<br/>- long_start_valid_time: 长按开始时间<br/>- long_keep_timer: 长按保持间隔<br/>- button_debounce_time: 消抖时间<br/>- button_repeat_valid_count: 多击次数<br/>- button_repeat_valid_time: 多击时间窗口
    
    TDL->>+TDD: 调用 __tdd_create_gpio_button
    Note right of TDD: 初始化 GPIO 硬件<br/>配置引脚模式(输入/上拉/下拉)<br/>设置中断(如果是中断模式)<br/>启用 GPIO 中断
    TDD-->>-TDL: 返回创建结果
    
    Note over TDL: 更新按键节点用户数据<br/>创建按键扫描任务<br/>启动状态机处理
    
    TDL-->>-App: 返回按键句柄

    Note over App, Bd: 注册按键事件回调
    
    App->>+TDL: 调用 tdl_button_event_register
    Note right of App: 传入按键句柄<br/>传入事件类型<br/>传入回调函数指针
    
    Note over TDL: 将回调函数注册到事件数组<br/>list_cb[event_type] = callback
    
    TDL-->>-App: 注册完成

    Note over App, Bd: 按键状态检测与事件处理
    
    loop 按键扫描循环
        Note over TDL: 扫描任务定时执行<br/>或中断触发检测
        
        TDL->>+TDD: 调用 __tdd_read_gpio_value
        Note right of TDD: 读取 GPIO 引脚状态<br/>处理有效电平逻辑<br/>返回按键状态(0/1)
        TDD-->>-TDL: 返回按键状态
        
        Note over TDL: 状态机处理 (__tdl_button_state_handle)<br/>- 消抖处理<br/>- 事件检测<br/>- 时间计算
        
        alt 检测到按键事件
            TDL->>App: 执行事件回调
            Note right of TDL: PUT_EVENT_CB(button, name, event, arg)<br/>调用应用注册的回调函数
            
            App->>App: 处理按键事件
            Note right of App: 执行业务逻辑<br/>如切换状态、发送命令等
        end
    end

    Note over App, Bd: 删除按键设备
    
    App->>+TDL: 调用 tdl_button_delete
    TDL->>+TDD: 调用 __tdd_delete_gpio_button
    Note right of TDD: 禁用 GPIO 中断<br/>去初始化 GPIO<br/>释放硬件资源
    TDD-->>-TDL: 返回删除结果
    
    Note over TDL: 从按键列表中移除节点<br/>释放内存资源<br/>停止扫描任务(如果是最后一个按键)
    
    TDL-->>-App: 返回删除结果
"></mermaid>
<h2 id=开发指导>开发指导</h2>
<h3 id=kconfig-配置>Kconfig 配置</h3>
<p>如果想要将驱动加入编译，需要在编译前检查是否开启相关 Kconfig 选项。在目标工程路径下，终端执行 <code>tos.py config menu</code> 查看以下配置选项。</p>
<table><thead><tr><th style=text-align:left>配置宏<th style=text-align:left>类型<th>说明<tbody><tr><td style=text-align:left>enable button<td style=text-align:left>布尔<td>该宏被打开，驱动代码才会参与编译<tr><td style=text-align:left>the num of button<td style=text-align:left>整型<td>配置按键数量<tr><td style=text-align:left>the name of button 1<td style=text-align:left>字符串<td>配置第一个按键的设备名<tr><td style=text-align:left>the name of button 2<td style=text-align:left>字符串<td>配置第二个按键的设备名<tr><td style=text-align:left>the name of button 3<td style=text-align:left>字符串<td>配置第三个按键的设备名<tr><td style=text-align:left>the name of button 4<td style=text-align:left>字符串<td>配置第四个按键的设备名</table>
<p><img alt=open_button src=/zh/assets/images/open_button-f2c4ae39df595a374801c435074d8c4a.png width=566 height=240 /></p>
<admonition type=tip><p>以上配置项需要在 <code>src/peripherals/button/Kconfig</code> 和 <code>boards/&lt;target_platform>/&lt;target_board>/Kconfig</code>（选择您的目标开发板查看 Kconfig 文件）中支持，若没有发现相关配置项，请检查这两个文件内容。</p></admonition>
<h3 id=运行环境>运行环境</h3>
<p>如果想要运行该驱动，需要先把驱动的 <strong>总使能宏</strong>（<code>ENABLE_BUTTON</code>）打开。打开该使能宏的方式有三种， <strong>Board 默认打开</strong>、<strong>开启了需要按键驱动的功能</strong> 和 <strong>手动打开</strong>。</p>
<admonition type=warning><p>以下所有命令都是需要切到目标应用目录下执行的，请勿直接在 TuyaOpen 根目录下或者其他目录下执行，否则执行会报错。</p></admonition>
<h4 id=目标-board-默认打开>目标 Board 默认打开</h4>
<admonition type=info><p>这种情况通常为您选择的开发板已经注册好了按键设备。此时，目标 Board 里的源文件中已经写好注册代码。例如，<code>TUYA_T5AI_BOARD</code> 开发板支持用户按键，在适配这块开发板时就已经注册好了按键设备，<code>boards/T5AI/TUYA_T5AI_BOARD/Kconfig</code> 文件也会写上 <code>select ENABLE_BUTTON</code>。
即只要开发者选择好对应的目标 Board，该驱动会自动被使能。</p></admonition>
<p>执行进入 Kconfig 菜单命令：</p>
<pre><code class=language-shell>tos.py config menu
</code></pre>
<admonition type=warning><p><code>boards/&lt;platform>/&lt;target_board>/Kconfig</code> 中执行了 <code>select ENABLE_XXX</code> 后，执行 <code>tos.py config menu</code> 无法手动选择/取消。</p></admonition>
<h4 id=开启了需要按键驱动的功能>开启了需要按键驱动的功能</h4>
<p>如果您选择了依赖按键驱动的功能，则按键驱动的使能宏也会被自动打开。</p>
<h4 id=手动打开使能宏>手动打开使能宏</h4>
<ol>
<li>
<p>执行进入 Kconfig 菜单命令：</p>
<pre><code class=language-shell>tos.py config menu
</code></pre>
</li>
<li>
<p>打开驱动使能宏。</p>
</li>
</ol>
<p><img alt="open button" src=/zh/assets/images/open_button-f2c4ae39df595a374801c435074d8c4a.png width=566 height=240 /></p>
<h3 id=使用方法>使用方法</h3>
<h4 id=适配按键驱动>适配按键驱动</h4>
<admonition type=tip><p>如果您在现有的按键驱动中找到了对应的驱动，可忽略这一步；如果没有找到适合自己的按键驱动，可自行适配驱动。</p></admonition>
<ol>
<li>在 <code>src/peripherals/button/tdd_button</code> 中新建 <code>tdd_button_xxx.c/h</code> 文件。</li>
<li>为设备 <strong>分配内存</strong>，根据自己的设备适配按键驱动的抽象接口（<code>button_create</code>、<code>button_delete</code>、<code>read_value</code> 等函数指针）。</li>
<li>调用 <strong>注册通用按键设备节点</strong> 接口（<code>tdl_button_register</code>）。</li>
<li>示例代码可参考已经适配好的 GPIO 按键驱动。</li>
</ol>
<p>具体的示例可以参考 <code>examples/peripherals/button</code>。</p>
<h4 id=注册按键设备>注册按键设备</h4>
<admonition type=tip><p>如果开发者选择的目标 Board 中已经注册好了按键设备，则只需要在 Kconfig 中选择该目标板，应用上调用 <code>board_register_hardware()</code> 接口即可，该接口中已经注册好对应的按键设备。</p></admonition>
<ol>
<li>
<p>根据您按键的型号与连接引脚编写注册接口。建议写在 <code>board_register_hardware()</code> 中，该接口实现的路径为 <code>boards/&lt;target_platform>/&lt;target_board>/xxx.c</code>。</p>
</li>
<li>
<p>配置设备的基本信息，在 <code>board_register_hardware()</code> 中调用注册接口。</p>
<pre><code class=language-c>OPERATE_RET __board_register_button(void)
{
    /* Write your struct configuration information here */
    /* begin */

    /* end */
    TUYA_CALL_ERR_RETURN(tdd_gpio_button_register(BUTTON_NAME, &button_cfg));
    return OPRT_OK;
}

OPERATE_RET board_register_hardware(void)
{
    TUYA_CALL_ERR_LOG(__board_register_button());
    return OPRT_OK;
}
</code></pre>
</li>
</ol>
<h4 id=控制设备>控制设备</h4>
<p>根据 <code>src/peripherals/button/tdl_button/include/tdl_button_manage.h</code> 中提供的 TDL 层接口，实现对按键设备的控制。</p>
<ul>
<li>创建按键设备实例并配置参数。</li>
<li>注册按键事件回调函数。</li>
<li>处理按键事件。</li>
<li>删除按键设备实例。</li>
</ul>
<h2 id=开发流程>开发流程</h2>
<p>只需要通过几个简单的 API 就可以完成按键外设的开发。</p>
<mermaid value="flowchart TD
    A[开始] --> B[注册硬件驱动<br/>tdd_gpio_button_register]
    B --> C[创建设备实例<br/>tdl_button_create]
    C --> D[绑定事件回调<br/>tdl_button_event_register]
    D --> E[事件触发处理<br/>__button_function_cb]
    E --> F[结束]
"></mermaid>
<p>关于按键的例程在 <code>examples/peripherals/button</code> 路径下，您可以在提供的例程基础上进行修改。</p>
<h2 id=接口说明>接口说明</h2>
<h3 id=按键设备配置结构体>按键设备配置结构体</h3>
<p>以 GPIO 按键为例，构建 TDD 层硬件配置信息结构体。</p>
<pre><code class=language-c>/**
 * @brief GPIO button configuration structure.
 * 
 * This structure contains all hardware configuration parameters for GPIO button,
 * including pin number, operation mode, active level, and pin type settings.
 */
typedef struct {
    TUYA_GPIO_NUM_E pin;           // GPIO pin number
    TUYA_GPIO_LEVEL_E level;       // Active level (HIGH/LOW)
    TDD_GPIO_TYPE_U pin_type;      // Pin configuration (pull-up/pull-down for scan mode, edge type for IRQ mode)
    TDL_BUTTON_MODE_E mode;        // Button operation mode (timer scan or interrupt)
} BUTTON_GPIO_CFG_T;

typedef union {
    TUYA_GPIO_MODE_E gpio_pull;    // GPIO pull mode for BUTTON_TIMER_SCAN_MODE
    TUYA_GPIO_IRQ_E irq_edge;      // IRQ edge type for BUTTON_IRQ_MODE
} TDD_GPIO_TYPE_U;
</code></pre>
<h3 id=按键软件配置结构体>按键软件配置结构体</h3>
<p>用于配置按键的软件参数，包括消抖时间、长按时间等。</p>
<pre><code class=language-c>/**
 * @brief Button software configuration structure.
 * 
 * This structure contains software configuration parameters for button behavior,
 * including debounce time, long press timing, and multi-click settings.
 */
typedef struct {
    uint16_t long_start_valid_time;    // Long press start valid time (ms)
    uint16_t long_keep_timer;          // Long press hold trigger interval (ms)
    uint16_t button_debounce_time;     // Button debounce time (ms)
    uint8_t button_repeat_valid_count; // Multi-click count threshold
    uint16_t button_repeat_valid_time; // Multi-click valid time window (ms)
} TDL_BUTTON_CFG_T;
</code></pre>
<h3 id=按键事件枚举>按键事件枚举</h3>
<p>定义按键支持的所有事件类型。</p>
<pre><code class=language-c>/**
 * @brief Button event types enumeration.
 * 
 * This enumeration defines all supported button event types that can be
 * detected and reported to the application layer.
 */
typedef enum {
    TDL_BUTTON_PRESS_DOWN = 0,     // Press down trigger
    TDL_BUTTON_PRESS_UP,           // Release trigger
    TDL_BUTTON_PRESS_SINGLE_CLICK, // Single click trigger
    TDL_BUTTON_PRESS_DOUBLE_CLICK, // Double click trigger
    TDL_BUTTON_PRESS_REPEAT,       // Multiple click trigger
    TDL_BUTTON_LONG_PRESS_START,   // Long press start trigger
    TDL_BUTTON_LONG_PRESS_HOLD,    // Long press hold trigger
    TDL_BUTTON_RECOVER_PRESS_UP,   // Recovery press up trigger
    TDL_BUTTON_PRESS_MAX,          // Maximum event count
    TDL_BUTTON_PRESS_NONE,         // No event
} TDL_BUTTON_TOUCH_EVENT_E;
</code></pre>
<h3 id=按键驱动注册结构体>按键驱动注册结构体</h3>
<p>为按键驱动注册结构体，您需要根据自己的按键驱动实现对应的函数指针。</p>
<pre><code class=language-c>/**
 * @brief Button driver interface structure.
 * 
 * This structure contains function pointers for all button operations, providing
 * a unified interface for the button abstract layer to call driver functions.
 */
typedef struct {
    OPERATE_RET (*button_create)(TDL_BUTTON_OPRT_INFO *dev);
    OPERATE_RET (*button_delete)(TDL_BUTTON_OPRT_INFO *dev);
    OPERATE_RET (*read_value)(TDL_BUTTON_OPRT_INFO *dev, uint8_t *value);
} TDL_BUTTON_CTRL_INFO;
</code></pre>
<h3 id=按键设备注册接口>按键设备注册接口</h3>
<p>该接口用于将按键设备驱动注册到系统中，是按键驱动框架的入口点。通过传入设备名称和配置参数，将按键设备添加到管理列表中供应用程序使用。</p>
<pre><code class=language-c>/**
 * @brief Registers a GPIO button device driver with the button management system.
 * 
 * This function registers a GPIO button device driver including device name and 
 * hardware configuration parameters. After successful registration, applications 
 * can create button instances and use the button device by name.
 * 
 * @param name Button device name used for identification and lookup
 * @param gpio_cfg GPIO button configuration parameters including pin number, 
 *                 operation mode, active level, and pin type settings
 * 
 * @return Returns OPRT_OK on successful registration, or an appropriate error code on failure.
 */
OPERATE_RET tdd_gpio_button_register(char *name, BUTTON_GPIO_CFG_T *gpio_cfg);
</code></pre>
<h3 id=按键驱动注册接口>按键驱动注册接口</h3>
<p>该接口用于将底层按键驱动接口注册到抽象层管理系统中，创建设备节点并维护设备列表。</p>
<pre><code class=language-c>/**
 * @brief Registers button device driver interfaces to the abstract layer management system.
 * 
 * This function registers button device driver interface functions to the button abstract 
 * layer management system, creates device nodes and adds them to the device management list 
 * for upper layer application calls.
 * 
 * @param name Button device name
 * @param button_ctrl_info Button driver interface structure containing various operation function pointers
 * @param button_cfg_info Button device configuration information
 * 
 * @return Returns OPRT_OK on successful registration, or an appropriate error code on failure.
 */
OPERATE_RET tdl_button_register(char *name, TDL_BUTTON_CTRL_INFO *button_ctrl_info,
                                TDL_BUTTON_DEVICE_INFO_T *button_cfg_info);
</code></pre>
<h3 id=设备创建接口>设备创建接口</h3>
<p>该接口用于创建按键设备实例并配置软件参数，使设备进入可用状态。</p>
<pre><code class=language-c>/**
 * @brief Creates a button device instance with specified configuration.
 * 
 * This function creates a button device instance based on the registered button driver,
 * configures software parameters such as debounce time and long press timing, and 
 * initializes the button hardware. After successful creation, the device enters a usable state.
 * 
 * @param name Button device name (must match registered name)
 * @param button_cfg Button software configuration parameters
 * @param handle Pointer to store the returned button device handle
 * 
 * @return Returns OPRT_OK on successful creation, or an appropriate error code on failure.
 */
OPERATE_RET tdl_button_create(char *name, TDL_BUTTON_CFG_T *button_cfg, TDL_BUTTON_HANDLE *handle);
</code></pre>
<h3 id=设备删除接口>设备删除接口</h3>
<p>该接口用于删除按键设备实例并释放相关资源，包括去初始化硬件、禁用引脚等清理工作。</p>
<pre><code class=language-c>/**
 * @brief Deletes a button device instance and releases related resources.
 * 
 * This function deletes the specified button device instance, deinitializes button hardware 
 * including disabling GPIO interrupts, releasing GPIO resources, and removing the device 
 * from the management list. After deletion, the device becomes unavailable.
 * 
 * @param handle Button device handle
 * 
 * @return Returns OPRT_OK on successful deletion, or an appropriate error code on failure.
 */
OPERATE_RET tdl_button_delete(TDL_BUTTON_HANDLE handle);
</code></pre>
<h3 id=事件回调注册接口>事件回调注册接口</h3>
<p>该接口用于注册按键事件回调函数，当检测到对应事件时会调用注册的回调函数。</p>
<pre><code class=language-c>/**
 * @brief Registers an event callback function for a specific button event.
 * 
 * This function registers a callback function for a specific button event type. When the 
 * specified event is detected, the registered callback function will be called with event 
 * information and parameters.
 * 
 * @param handle Button device handle
 * @param event Button event type to register callback for
 * @param cb Callback function pointer to be called when event occurs
 * 
 * @return None
 */
void tdl_button_event_register(TDL_BUTTON_HANDLE handle, TDL_BUTTON_TOUCH_EVENT_E event, TDL_BUTTON_EVENT_CB cb);
</code></pre>
<h3 id=按键状态读取接口>按键状态读取接口</h3>
<p>该接口用于读取按键的当前状态。</p>
<pre><code class=language-c>/**
 * @brief Reads the current status of a button device.
 * 
 * This function reads the current physical status of the specified button device,
 * returning whether the button is currently pressed or released.
 * 
 * @param handle Button device handle
 * @param status Pointer to store the button status (0: released, 1: pressed)
 * 
 * @return Returns OPRT_OK on successful reading, or an appropriate error code on failure.
 */
OPERATE_RET tdl_button_read_status(TDL_BUTTON_HANDLE handle, uint8_t *status);
</code></pre>
<h3 id=按键电平设置接口>按键电平设置接口</h3>
<p>该接口用于动态设置按键的有效电平，适用于拨码开关等应用场景。</p>
<pre><code class=language-c>/**
 * @brief Sets the active level of a button device.
 * 
 * This function dynamically sets the active level of the specified button device.
 * This is useful for toggle switches where the effective level needs to be changed
 * during runtime.
 * 
 * @param handle Button device handle
 * @param level Active level to set (TUYA_GPIO_LEVEL_HIGH or TUYA_GPIO_LEVEL_LOW)
 * 
 * @return Returns OPRT_OK on successful setting, or an appropriate error code on failure.
 */
OPERATE_RET tdl_button_set_level(TDL_BUTTON_HANDLE handle, TUYA_GPIO_LEVEL_E level);
</code></pre>
<h3 id=扫描时间配置接口>扫描时间配置接口</h3>
<p>该接口用于配置按键扫描的时间间隔。</p>
<pre><code class=language-c>/**
 * @brief Sets the button scan time interval.
 * 
 * This function sets the time interval for button scanning. The default scan time
 * is 10ms. Shorter intervals provide better responsiveness but consume more CPU resources.
 * 
 * @param time_ms Button scan time interval in milliseconds
 * 
 * @return Returns OPRT_OK on successful setting, or an appropriate error code on failure.
 */
OPERATE_RET tdl_button_set_scan_time(uint8_t time_ms);
</code></pre>
<h3 id=深度睡眠控制接口>深度睡眠控制接口</h3>
<p>该接口用于控制按键功能的开启和关闭，适用于低功耗应用场景。</p>
<pre><code class=language-c>/**
 * @brief Controls button functionality for deep sleep scenarios.
 * 
 * This function enables or disables button functionality, which is useful for 
 * power management in battery-powered devices. When disabled, button scanning
 * and event detection are suspended to save power.
 * 
 * @param enable Enable flag (0: disable, 1: enable)
 * 
 * @return Returns OPRT_OK on successful control, or an appropriate error code on failure.
 */
OPERATE_RET tdl_button_deep_sleep_ctrl(uint8_t enable);
</code></pre>
<h2 id=注意事项>注意事项</h2>
<h3 id=硬件配置注意事项>硬件配置注意事项</h3>
<ul>
<li><strong>引脚选择</strong>：确保选择的 GPIO 引脚支持所需的功能（输入、上拉/下拉、中断等）。</li>
<li><strong>电平配置</strong>：正确配置按键的有效电平，与硬件电路设计保持一致。</li>
<li><strong>上拉/下拉配置</strong>：根据按键连接方式正确配置内部上拉或下拉电阻。</li>
<li><strong>中断边沿</strong>：中断模式下需要根据有效电平正确配置中断触发边沿。</li>
</ul>
<h3 id=软件配置注意事项>软件配置注意事项</h3>
<ul>
<li><strong>消抖时间设置</strong>：建议范围为 20 - 50 ms，过短可能导致误触发，过长会影响响应速度。</li>
<li><strong>长按时间配置</strong>：根据用户体验需求合理设置长按开始时间和保持间隔。</li>
<li><strong>多击时间窗口</strong>：双击/多击的时间窗口应该符合用户操作习惯，通常为 300 - 800 ms。</li>
<li><strong>扫描时间间隔</strong>：默认 10 ms 适用于大多数场景，可根据实际需求调整。</li>
</ul>
<h3 id=功耗优化建议>功耗优化建议</h3>
<ul>
<li><strong>中断模式优先</strong>：低功耗场景建议使用中断模式而非轮询扫描。</li>
<li><strong>深度睡眠控制</strong>：在不需要按键功能时，请及时关闭以节省功耗。</li>
<li><strong>扫描频率优化</strong>：适当增加扫描间隔可以降低功耗，但会影响响应速度。</li>
</ul>
<h3 id=线程安全注意事项>线程安全注意事项</h3>
<ul>
<li><strong>回调函数限制</strong>：避免在回调函数中执行耗时操作，可能会影响其他按键的检测。</li>
<li><strong>资源竞争</strong>：多个按键共享扫描任务时，注意避免资源竞争问题。</li>
<li><strong>中断上下文</strong>：中断模式下的回调函数运行在中断上下文中，需要注意中断安全。</li>
</ul>
<h3 id=调试建议>调试建议</h3>
<ul>
<li><strong>日志输出</strong>：开启按键相关的调试日志有助于问题定位。</li>
<li><strong>状态监控</strong>：可以通过 <code>tdl_button_read_status</code> 接口监控按键的实时状态。</li>
<li><strong>事件统计</strong>：在回调函数中添加事件计数，便于验证按键功能是否正常。</li>
</ul>
<h3 id=常见问题解决>常见问题解决</h3>
<ul>
<li><strong>按键无响应</strong>：检查 GPIO 配置、有效电平设置、驱动注册是否正确。</li>
<li><strong>误触发频繁</strong>：适当增加消抖时间，检查硬件电路是否有干扰。</li>
<li><strong>长按不触发</strong>：检查长按时间配置是否合理，确认硬件连接稳定。</li>
<li><strong>双击识别失败</strong>：调整双击时间窗口，确保用户操作在有效时间内。</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href=https://github.com/Tuya-Community/TuyaOpen.io/edit/master/i18n/zh/docusaurus-plugin-content-docs/current/peripheral/button.md target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label=文件选项卡><a class="pagination-nav__link pagination-nav__link--prev" href=/zh/docs/peripheral/audio><div class=pagination-nav__sublabel>上一页</div><div class=pagination-nav__label>音频驱动</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/zh/docs/new-hardware/porting-platform><div class=pagination-nav__sublabel>下一页</div><div class=pagination-nav__label>适配新 Platform</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#概述 class="table-of-contents__link toc-highlight">概述</a><li><a href=#前置概念 class="table-of-contents__link toc-highlight">前置概念</a><li><a href=#按键连接框架 class="table-of-contents__link toc-highlight">按键连接框架</a><ul><li><a href=#上拉按键连接框架 class="table-of-contents__link toc-highlight">上拉按键连接框架</a><li><a href=#下拉按键连接框架 class="table-of-contents__link toc-highlight">下拉按键连接框架</a></ul><li><a href=#功能模块 class="table-of-contents__link toc-highlight">功能模块</a><ul><li><a href=#抽象管理模块tuya-driver-layertdl class="table-of-contents__link toc-highlight">抽象管理模块（Tuya Driver Layer，TDL）</a><li><a href=#实例化注册模块tuya-device-drivertdd class="table-of-contents__link toc-highlight">实例化注册模块（Tuya Device Driver，TDD）</a></ul><li><a href=#功能介绍 class="table-of-contents__link toc-highlight">功能介绍</a><li><a href=#支持外设列表 class="table-of-contents__link toc-highlight">支持外设列表</a><li><a href=#工作流程 class="table-of-contents__link toc-highlight">工作流程</a><li><a href=#开发指导 class="table-of-contents__link toc-highlight">开发指导</a><ul><li><a href=#kconfig-配置 class="table-of-contents__link toc-highlight">Kconfig 配置</a><li><a href=#运行环境 class="table-of-contents__link toc-highlight">运行环境</a><li><a href=#使用方法 class="table-of-contents__link toc-highlight">使用方法</a></ul><li><a href=#开发流程 class="table-of-contents__link toc-highlight">开发流程</a><li><a href=#接口说明 class="table-of-contents__link toc-highlight">接口说明</a><ul><li><a href=#按键设备配置结构体 class="table-of-contents__link toc-highlight">按键设备配置结构体</a><li><a href=#按键软件配置结构体 class="table-of-contents__link toc-highlight">按键软件配置结构体</a><li><a href=#按键事件枚举 class="table-of-contents__link toc-highlight">按键事件枚举</a><li><a href=#按键驱动注册结构体 class="table-of-contents__link toc-highlight">按键驱动注册结构体</a><li><a href=#按键设备注册接口 class="table-of-contents__link toc-highlight">按键设备注册接口</a><li><a href=#按键驱动注册接口 class="table-of-contents__link toc-highlight">按键驱动注册接口</a><li><a href=#设备创建接口 class="table-of-contents__link toc-highlight">设备创建接口</a><li><a href=#设备删除接口 class="table-of-contents__link toc-highlight">设备删除接口</a><li><a href=#事件回调注册接口 class="table-of-contents__link toc-highlight">事件回调注册接口</a><li><a href=#按键状态读取接口 class="table-of-contents__link toc-highlight">按键状态读取接口</a><li><a href=#按键电平设置接口 class="table-of-contents__link toc-highlight">按键电平设置接口</a><li><a href=#扫描时间配置接口 class="table-of-contents__link toc-highlight">扫描时间配置接口</a><li><a href=#深度睡眠控制接口 class="table-of-contents__link toc-highlight">深度睡眠控制接口</a></ul><li><a href=#注意事项 class="table-of-contents__link toc-highlight">注意事项</a><ul><li><a href=#硬件配置注意事项 class="table-of-contents__link toc-highlight">硬件配置注意事项</a><li><a href=#��软件配置注意事项 class="table-of-contents__link toc-highlight">软件配置注意事项</a><li><a href=#功耗优化建议 class="table-of-contents__link toc-highlight">功耗优化建议</a><li><a href=#线程安全注意事项 class="table-of-contents__link toc-highlight">线程安全注意事项</a><li><a href=#调试建议 class="table-of-contents__link toc-highlight">调试建议</a><li><a href=#常见问题解决 class="table-of-contents__link toc-highlight">常见问题解决</a></ul></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class=footer__title>文档</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/zh/docs/quick-start/unboxing>教程</a><li class=footer__item><a class=footer__link-item href=/zh/pricing>服务</a><li class=footer__item><a class=footer__link-item href=/zh/docs/hardware-specific>硬件支持清单</a><li class=footer__item><a class=footer__link-item href=/zh/docs/hardware-specific/t5-ai-board/overview-t5-ai-board>Tuya T5AI 开发套件</a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>工具</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://tuyaopen.ai/tools target=_blank rel="noopener noreferrer" class=footer__link-item>Web Serial 工具<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>社区</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://discord.com/invite/yPPShSTttG target=_blank rel="noopener noreferrer" class=footer__link-item>Discord<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://x.com/tuyasmart target=_blank rel="noopener noreferrer" class=footer__link-item>X<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://www.youtube.com/@tuya2023 target=_blank rel="noopener noreferrer" class=footer__link-item>Youtube<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://www.linkedin.com/company/tuya-smart target=_blank rel="noopener noreferrer" class=footer__link-item>Linkedin<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>更多</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://github.com/tuya/TuyaOpen target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a href=https://gitee.com/tuya-open/TuyaOpen target=_blank rel="noopener noreferrer" class=footer__link-item>Gitee(Mirror)<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>致谢</div><ul class="footer__items clean-list"><li class=footer__item><a href=https://storyset.com/technology target=_blank rel="noopener noreferrer" class=footer__link-item>Thanks for the technology illustrations by Storyset<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a></ul></div></div><div class="footer__bottom text--center"><div class=footer__copyright>
        <p style="font-weight: 500;">版权所有 © TuyaOpen Authors 2025 | Documentation Distributed under Apache License Version 2.0</p>
</div></div></div></footer></div></body>